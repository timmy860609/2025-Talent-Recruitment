$(function() {
    function t(t, s, a, e, n, i) {
        var o = $('<div id="' + e + "-" + t + '" class="overlay ' + e + '"></div>');
        i && (s = s + "<small>" + i + "</small>");
        var c = $('<div class="inner"></div>');
        $('<button class="button close" type="button">&times;</button>').appendTo(c);
        var l = "";
        "pl" == e ? (l += '<div class="head">',
        l += '<div class="img">',
        l += "</div>",
        l += '<div class="name h5">' + s + "</div>",
        l += "</div>") : "jb" == e ? (l += '<div class="head">',
        l += '<div class="img">',
        l += "</div>",
        l += '<div class="name h5">' + s + "</div>",
        l += "</div>") : $('<div class="h5 header">' + s + "</div>").appendTo(c);
        var d = $('<div class="overlay-content">' + l + '<div class="inner-body">' + a + "</div></div>");
        d.appendTo(c),
        "pl" != e && "jb" != e || d.find(".img").attr("style", n),
        c.appendTo(o),
        o.appendTo("body")
    }
    function s() {
        $(".ex").each(function() {
            this.getBoundingClientRect().top <= .75 * $(window).height() && !$(this).hasClass("active") && (d -= 1,
            e(this.getBoundingClientRect().top),
            $(this).addClass("active"))
        });

        // Check if #section2 .item-chart ul.stairs has the class "active"
        if ($('#section2 .item-chart ul.stairs').hasClass("active")) {
            // Add "active" class to all .ex elements inside it
            $('#section2 .item-chart ul.stairs .ex').addClass("active");
        }

        e("ex all = " + d);
        if (d === 0) {
            $(document).off("touchmove scroll");
        }
    }
    function a() {
        l.removeClass("show").attr("style", "background-image: url(" + u[v] + ")"),
        setTimeout(function() {
            l.addClass("show")
        }, 20),
        setTimeout(function() {
            c.attr("style", l.attr("style"))
        }, m + 500),
        v = v + 1 < u.length ? v += 1 : 0
    }
    function e(t) {
        // console.log(t)
    }
    $(".chart1")[0],
    $(".chart2")[0];
    var n = $("#yuanta")
      , i = $("#award")
      , o = $("#menu")
      , c = $("#section0")
      , l = $("#visual-bg")
      , d = $(".ex").length
      , r = 0
      , u = ["./assets/css/img/visual/v1.jpg"]
      , v = 0
      , h = 8
      , m = 3e3;
    "none" == l.css("display") || function() {
        for (var t = 0; t < u.length; t++) {
            var s = new Image;
            s.onload = void ((r += 1) == u.length && setInterval(a, 1e3 * h)),
            s.src = u[t]
        }
    }(),
    n.appendTo("body"),
    i.appendTo("body"),
    $(".people").each(function(s) {
        $(this).attr("data-id", s);

        let originalStyle = $(this).find(".imgbox").attr("style");
        let modifiedStyle = originalStyle.replace("url(assets/images/people/", "url(assets/images/people/avatar/").replace(".jpg", ".png");
        modifiedStyle = modifiedStyle.replace("background-position", "background-position: center; background-size: cover;");
        t(s, $(this).find(".name").text(), "<h6>" + $(this).find(".words").html() + "</h6>" + $(this).find(".hide-content").html(), "pl", modifiedStyle, $(this).find(".job-sub-title").text());

        // t(s, $(this).find(".name").text(), "<h6>" + $(this).find(".words").html() + "</h6>" + $(this).find(".hide-content").html(), "pl", $(this).find(".imgbox").attr("style"), $(this).find(".job-sub-title").text())
    }),
    $(".job").each(function(s) {
        $(this).attr("data-id", s),
        t(s, $(this).find(".job-header").text(), "<h6>" + $(this).find(".job-header-second").html() + "</h6>" + $(this).find(".hide-content").html(), "jb", $(this).find(".imgbox").attr("style"))
    }),
    $(".date-check").each(function() {
        (function(t, s) {
            var a = new Date
              , e = [a.getFullYear(), a.getMonth() + 1, a.getDate()]
              , n = t.substr(0, 10).split("/")
              , i = s.substr(0, 10).split("/")
              , o = new Date(n[0],parseInt(n[1]) - 1,n[2])
              , c = new Date(i[0],parseInt(i[1]) - 1,i[2])
              , l = new Date(e[0],parseInt(e[1]) - 1,e[2]);
            return l >= o && l <= c
        }
        )($(this).data("min"), $(this).data("max")) && $(this).addClass("active")
    }),
    $("dt").on("click", function(t) {
        $(this).toggleClass("active"),
        t.preventDefault()
    }),
    $("#section3-detail .tab").on("click", function() {
        $('#section3 .sub').attr("style", "background: #efefef; position: relative; width: 90%; height: auto;")
        $('#section3 .sub .sub-block').attr("style", "display: none;")
        $('#section3-detail .tab').removeClass("active")
        $(this).addClass("active")
    }),
    $(".btn-jump").on("click", function() {
        return setTimeout(function() {
            $("html, body").animate({
                scrollTop: $("#section4").offset().top
            }, 700)
        }, 400),
        !1
    }),
    $(".btn-menu").on("click", function() {
        return $("body").addClass("lock"),
        o.addClass("active"),
        !1
    }),
    // $(".btn-yuanta").on("click", function() {
    //     return $("body").addClass("lock"),
    //     n.addClass("active"),
    //     !1
    // }),
    $(document).on("click", ".overlay, .overlay .close", function (e) {
        if (e.target.target === '_blank') return true;
        return $("body").removeClass("lock"),
        $(this).closest(".overlay").removeClass("active"),
        !1
    }),
    $(document).on("click", ".overlay .inner", function() {
        return !1
    }),
    $(".people").on("click", function() {
        return $("body").addClass("lock"),
        $("#pl-" + $(this).data("id")).addClass("active"),
        !1
    }),
    $(".job").on("click", function() {
        return $("body").addClass("lock"),
        $("#jb-" + $(this).data("id")).addClass("active"),
        !1
    }),
    $(".jump").on("click", function() {
        $("body").removeClass("lock"),
        $("#menu").removeClass("active");
        var t = $(this).attr("href")
          , s = $("#top").outerHeight();
        return setTimeout(function() {
            $("html, body").animate({
                scrollTop: $(t).offset().top - s
            }, 0)
        }, 400),
        !1
    }),
    $(".btn-calendar-single").on("click", function() {
        var t = $(this).data("id")
          , s = "";
        switch (t.substr(0, 1)) {
        case "a":
            s = "./assets/ics/yuanta-ma-expo-" + t.substr(1, 1) + ".ics";
            break;
        case "b":
            s = "./assets/ics/yuanta-ma-seminar-" + t.substr(1, 1) + ".ics"
        }
        return s && (window.location.href = s),
        !1
    }),
    $(document).on("touchmove scroll", s),
    s()
});
